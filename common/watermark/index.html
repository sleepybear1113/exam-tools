<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>水印打印工具</title>
    <link rel="stylesheet" href="./index.css">
</head>
<body>
<div class="container">
    <div id="header" class="header">
        <h1>🖨️ 水印打印工具</h1>
        <p>可以批量给文档的不同页面打印上不同的水印</p>
    </div>

    <div id="controls" class="controls">
        <div class="controls-grid">
            <div class="form-group">
                <label for="paperSize">📄 纸张类型</label>
                <select id="paperSize">
                    <option value="A3">A3</option>
                    <option value="A4" selected>A4</option>
                </select>
            </div>
            <div class="form-group">
                <label for="orientation">🔄 纸张方向</label>
                <select id="orientation">
                    <option value="landscape">横向</option>
                    <option value="portrait" selected>纵向</option>
                </select>
            </div>
            <div class="form-group">
                <label for="gapX">↔️ 横向水印间隔 (mm)</label>
                <input type="number" id="gapX" value="50" min="10" max="200">
            </div>
            <div class="form-group">
                <label for="gapY">↕️ 纵向水印间隔 (mm)</label>
                <input type="number" id="gapY" value="30" min="10" max="200">
            </div>
            <div class="form-group">
                <label for="angleDeg">📐 水印旋转角度 (°)</label>
                <input type="number" id="angleDeg" value="-15" min="-90" max="90">
            </div>
            <div class="form-group">
                <label for="fontSize">🔤 字号 (px)</label>
                <input type="number" id="fontSize" value="20" min="8" max="72">
            </div>
            <div class="form-group">
                <label for="fontFamily">📝 字体</label>
                <select id="fontFamily">
                    <option value="SimHei" selected>黑体 (SimHei, Windows)</option>
                    <option value="SimSun">宋体 (SimSun, Windows)</option>
                    <option value="Microsoft YaHei">微软雅黑 (Microsoft YaHei, Windows)</option>
                    <option value="Arial">Arial (Win/Mac/Linux)</option>
                    <option value="Times New Roman">Times New Roman (Win/Mac/Linux)</option>
                    <option value="PingFang SC">苹方 (PingFang SC, Mac)</option>
                    <option value="Hiragino Sans GB">冬青黑体 (Hiragino Sans GB, Mac)</option>
                    <option value="Heiti SC">黑体 (Heiti SC, Mac)</option>
                    <option value="WenQuanYi Micro Hei">文泉驿微米黑 (WenQuanYi Micro Hei, Linux)</option>
                    <option value="Noto Sans CJK SC">思源黑体/Noto Sans CJK SC (Linux/统信UOS/通用)</option>
                    <option value="Source Han Sans SC">思源黑体/Source Han Sans SC (通用)</option>
                    <option value="YouSheBiaoTiHei">优设标题黑 (YouSheBiaoTiHei, 统信UOS)</option>
                    <option value="FangSong">仿宋 (FangSong, Windows)</option>
                    <option value="KaiTi">楷体 (KaiTi, Windows)</option>
                    <option value="DejaVu Sans">DejaVu Sans (Linux)</option>
                    <option value="Liberation Sans">Liberation Sans (Linux)</option>
                    <option value="monospace">等宽/Monospace</option>
                    <option value="serif">衬线/Serif</option>
                    <option value="sans-serif">无衬线/Sans-serif</option>
                </select>
            </div>
            <div class="form-group">
                <label for="opacity">👁️ 不透明度(0.00 - 1.00)</label>
                <input type="number" id="opacity" value="0.30" step="0.05" min="0" max="1">
            </div>
            <div class="form-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="showLineNumber">
                    <label for="showLineNumber">📝 显示行号并补零</label>
                </div>
            </div>
        </div>

        <div class="input-section">
            <label for="input">💬 水印文本内容 (每行一条)</label>
            <textarea id="input"
                      placeholder="请输入水印文本内容，每行一个&#10;例如：&#10;张三 - 北京大学&#10;李四 - 清华大学&#10;王五 - 复旦大学&#10;赵六 - 上海交通大学&#10;钱七 - 浙江大学&#10;孙八 - 南京大学"></textarea>
        </div>

        <div class="button-group">
            <button class="btn btn-secondary" onclick="loadTestSample()">
                🧪 加载展示样例水印
            </button>
            <button class="btn btn-primary" onclick="generate()">
                👁️ 生成预览
            </button>
            <button class="btn btn-secondary" onclick="window.print()">
                🖨️ 打印
            </button>
        </div>
    </div>

    <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>正在生成预览...</p>
    </div>

    <div id="preview">
        <div class="preview-header">
            <h3>📋 预览效果</h3>
            <p>以下是生成的水印预览，每页对应一行输入文本</p>
        </div>
    </div>
</div>

<script src="./index.js"></script>
</body>
</html>
